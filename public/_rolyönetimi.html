<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rol Yönetimi</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f8fafc; /* Tailwind: slate-50 */
            /* Kenarlardaki boşlukları kaldırmak için padding'i sıfırladık */
            padding: 0; 
            margin: 0;
        }
        /* Modal penceresinin açılış/kapanış animasyonu */
        .modal-scale-enter-active, .modal-scale-leave-active {
            transition: all 0.2s ease-in-out;
        }
        .modal-scale-enter-from, .modal-scale-leave-to {
            opacity: 0;
            transform: scale(0.95);
        }
        /* Hide scrollbar for Tailwind custom scrollbar */
        .custom-scrollbar::-webkit-scrollbar {
            width: 0px;
        }
    </style>
</head>
<body class="antialiased">

    <main class="w-full py-8 px-4 sm:px-6 lg:px-8"> 
        <div class="flex flex-col items-start justify-between gap-4 border-b border-slate-200 pb-5 sm:flex-row sm:items-center">
            <div>
                <h1 class="text-2xl font-bold tracking-tight text-slate-900 sm:text-3xl">Rol Yönetimi</h1>
                <p class="mt-1 text-sm text-slate-600">Sistemdeki kullanıcı rollerini ve yetkilerini yönetin.</p>
            </div>
            <button id="addNewRoleBtn" class="flex items-center gap-2 rounded-lg bg-emerald-600 px-4 py-2.5 text-sm font-semibold text-white shadow-sm transition-colors hover:bg-emerald-700 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-emerald-600">
                <i class="fa-solid fa-plus"></i>
                <span>Yeni Rol Ekle</span>
            </button>
        </div>

        <div class="mt-8 flow-root">
            <div class="-mx-4 -my-2 overflow-x-auto sm:-mx-6 lg:-mx-8">
                <div class="inline-block min-w-full py-2 align-middle sm:px-6 lg:px-8">
                    <div class="overflow-hidden rounded-lg shadow-sm ring-1 ring-slate-200">
                        <table class="min-w-full divide-y divide-slate-200">
                            <thead class="bg-slate-50">
                                <tr>
                                    <th scope="col" class="py-3.5 pl-4 pr-3 text-left text-xs font-semibold uppercase tracking-wider text-slate-500 sm:pl-6">ID</th>
                                    <th scope="col" class="px-3 py-3.5 text-left text-xs font-semibold uppercase tracking-wider text-slate-500">Rol Adı</th>
                                    <th scope="col" class="px-3 py-3.5 text-left text-xs font-semibold uppercase tracking-wider text-slate-500">Açıklama</th>
                                    <th scope="col" class="px-3 py-3.5 text-left text-xs font-semibold uppercase tracking-wider text-slate-500">İzinler</th>
                                    <th scope="col" class="px-3 py-3.5 text-left text-xs font-semibold uppercase tracking-wider text-slate-500">Oluşturulma Tarihi</th>
                                    <th scope="col" class="relative py-3.5 pl-3 pr-4 sm:pr-6"><span class="sr-only">Eylemler</span></th>
                                </tr>
                            </thead>
                            <tbody class="divide-y divide-slate-200 bg-white">
                                <tr>
                                    <td class="whitespace-nowrap py-4 pl-4 pr-3 text-sm font-medium text-slate-900 sm:pl-6">1</td>
                                    <td class="whitespace-nowrap px-3 py-4 text-sm text-slate-700">Admin</td>
                                    <td class="whitespace-nowrap px-3 py-4 text-sm text-slate-500">Tam yetkili sistem yöneticisi</td>
                                    <td class="whitespace-nowrap px-3 py-4 text-sm">
                                        <span class="inline-flex items-center rounded-full bg-emerald-50 px-2.5 py-1 text-xs font-medium text-emerald-700 ring-1 ring-inset ring-emerald-600/20">Tüm İzinler</span>
                                    </td>
                                    <td class="whitespace-nowrap px-3 py-4 text-sm text-slate-500">2025-07-23</td>
                                    <td class="relative whitespace-nowrap py-4 pl-3 pr-4 text-right text-sm font-medium sm:pr-6">
                                        <a href="#" class="text-emerald-600 hover:text-emerald-800"><i class="fa-solid fa-pencil"></i></a>
                                        <a href="#" class="ml-4 text-rose-600 hover:text-rose-800"><i class="fa-solid fa-trash"></i></a>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="whitespace-nowrap py-4 pl-4 pr-3 text-sm font-medium text-slate-900 sm:pl-6">2</td>
                                    <td class="whitespace-nowrap px-3 py-4 text-sm text-slate-700">Moderator</td>
                                    <td class="whitespace-nowrap px-3 py-4 text-sm text-slate-500">Sınırlı yönetim yetkisi</td>
                                    <td class="whitespace-nowrap px-3 py-4 text-sm">
                                        <span class="inline-flex items-center rounded-full bg-blue-50 px-2.5 py-1 text-xs font-medium text-blue-700 ring-1 ring-inset ring-blue-600/20">4 İzin Atanmış</span>
                                    </td>
                                    <td class="whitespace-nowrap px-3 py-4 text-sm text-slate-500">2025-07-23</td>
                                    <td class="relative whitespace-nowrap py-4 pl-3 pr-4 text-right text-sm font-medium sm:pr-6">
                                        <a href="#" class="text-emerald-600 hover:text-emerald-800"><i class="fa-solid fa-pencil"></i></a>
                                        <a href="#" class="ml-4 text-rose-600 hover:text-rose-800"><i class="fa-solid fa-trash"></i></a>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="whitespace-nowrap py-4 pl-4 pr-3 text-sm font-medium text-slate-900 sm:pl-6">4</td>
                                    <td class="whitespace-nowrap px-3 py-4 text-sm text-slate-700">Genel Merkez</td>
                                    <td class="whitespace-nowrap px-3 py-4 text-sm text-slate-500">Genel Merkez Yönetimi</td>
                                    <td class="whitespace-nowrap px-3 py-4 text-sm">
                                        <span class="inline-flex items-center rounded-full bg-emerald-50 px-2.5 py-1 text-xs font-medium text-emerald-700 ring-1 ring-inset ring-emerald-600/20">Tüm İzinler</span>
                                    </td>
                                    <td class="whitespace-nowrap px-3 py-4 text-sm text-slate-500">2025-08-18</td>
                                    <td class="relative whitespace-nowrap py-4 pl-3 pr-4 text-right text-sm font-medium sm:pr-6">
                                        <a href="#" class="text-emerald-600 hover:text-emerald-800"><i class="fa-solid fa-pencil"></i></a>
                                        <a href="#" class="ml-4 text-rose-600 hover:text-rose-800"><i class="fa-solid fa-trash"></i></a>
                                    </td>
                                </tr>
                                 <tr>
                                    <td class="whitespace-nowrap py-4 pl-4 pr-3 text-sm font-medium text-slate-900 sm:pl-6">8</td>
                                    <td class="whitespace-nowrap px-3 py-4 text-sm text-slate-700">Gönüllü</td>
                                    <td class="whitespace-nowrap px-3 py-4 text-sm text-slate-500">Gönüllü</td>
                                    <td class="whitespace-nowrap px-3 py-4 text-sm">
                                        <span class="inline-flex items-center rounded-full bg-blue-50 px-2.5 py-1 text-xs font-medium text-blue-700 ring-1 ring-inset ring-blue-600/20">3 İzin Atanmış</span>
                                    </td>
                                    <td class="whitespace-nowrap px-3 py-4 text-sm text-slate-500">2025-08-18</td>
                                    <td class="relative whitespace-nowrap py-4 pl-3 pr-4 text-right text-sm font-medium sm:pr-6">
                                        <a href="#" class="text-emerald-600 hover:text-emerald-800"><i class="fa-solid fa-pencil"></i></a>
                                        <a href="#" class="ml-4 text-rose-600 hover:text-rose-800"><i class="fa-solid fa-trash"></i></a>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <div id="roleModal" class="relative z-10 hidden" aria-labelledby="modal-title" role="dialog" aria-modal="true">
        <div id="modalBackdrop" class="fixed inset-0 bg-slate-900/60 backdrop-blur-sm transition-opacity"></div>
        
        <div class="fixed inset-0 z-10 w-screen overflow-y-auto">
            <div class="flex min-h-full items-center justify-center p-4 text-center sm:items-center sm:p-0">
                <div id="modalPanel" class="modal-scale-enter-from relative w-full max-w-2xl transform overflow-hidden rounded-xl bg-white text-left shadow-2xl transition-all">
                    <form>
                        <div class="bg-white p-6 sm:p-8">
                            <div class="flex items-start justify-between">
                                <div>
                                    <h2 class="text-xl font-bold text-slate-900" id="modal-title">Yeni Rol Oluştur</h2>
                                    <p class="mt-1 text-sm text-slate-600">Bu rolün detaylarını ve atanacak izinleri belirtin.</p>
                                </div>
                                <button type="button" id="closeModalBtn" class="text-slate-400 hover:text-slate-600">
                                    <span class="sr-only">Kapat</span>
                                    <i class="fa-solid fa-xmark fa-lg"></i>
                                </button>
                            </div>
                            
                            <div class="mt-6 grid grid-cols-1 gap-x-6 gap-y-6 sm:grid-cols-6">
                                <div class="sm:col-span-6">
                                    <label for="roleName" class="block text-sm font-medium leading-6 text-slate-900">Rol Adı (role_name)</label>
                                    <div class="mt-2">
                                        <input type="text" name="roleName" id="roleName" placeholder="Örn: ilce_baskani" class="block w-full rounded-md border-0 py-2.5 px-3 text-slate-900 shadow-sm ring-1 ring-inset ring-slate-300 placeholder:text-slate-400 focus:ring-2 focus:ring-inset focus:ring-emerald-600 sm:text-sm sm:leading-6">
                                    </div>
                                </div>
                                <div class="sm:col-span-6">
                                    <label for="roleDesc" class="block text-sm font-medium leading-6 text-slate-900">Açıklama (role_description)</label>
                                    <div class="mt-2">
                                        <textarea id="roleDesc" name="roleDesc" rows="3" placeholder="Bu rolün amacını ve yetkilerini açıklayın." class="block w-full rounded-md border-0 py-2.5 px-3 text-slate-900 shadow-sm ring-1 ring-inset ring-slate-300 placeholder:text-slate-400 focus:ring-2 focus:ring-inset focus:ring-emerald-600 sm:text-sm sm:leading-6"></textarea>
                                    </div>
                                </div>

                                <div class="sm:col-span-6">
                                    <label class="block text-sm font-medium leading-6 text-slate-900">İzinler (permissions)</label>
                                    <div class="custom-scrollbar mt-2 max-h-48 overflow-y-auto rounded-lg border border-slate-200 p-2">
                                        <div class="grid grid-cols-1 gap-2 sm:grid-cols-2 lg:grid-cols-3">
                                            <label class="flex cursor-pointer items-center gap-3 rounded-md p-2 ring-1 ring-slate-200 transition-colors has-[:checked]:bg-emerald-50 has-[:checked]:ring-emerald-400">
                                                <input type="checkbox" name="permissions" value="users.view" class="h-4 w-4 rounded border-slate-300 text-emerald-600 focus:ring-emerald-600">
                                                <span class="text-sm font-medium text-slate-700">Kullanıcıları Görüntüle</span>
                                            </label>
                                            <label class="flex cursor-pointer items-center gap-3 rounded-md p-2 ring-1 ring-slate-200 transition-colors has-[:checked]:bg-emerald-50 has-[:checked]:ring-emerald-400">
                                                <input type="checkbox" name="permissions" value="users.manage" class="h-4 w-4 rounded border-slate-300 text-emerald-600 focus:ring-emerald-600">
                                                <span class="text-sm font-medium text-slate-700">Kullanıcıları Yönet</span>
                                             </label>
                                             <label class="flex cursor-pointer items-center gap-3 rounded-md p-2 ring-1 ring-slate-200 transition-colors has-[:checked]:bg-emerald-50 has-[:checked]:ring-emerald-400">
                                                <input type="checkbox" name="permissions" value="events.view" class="h-4 w-4 rounded border-slate-300 text-emerald-600 focus:ring-emerald-600">
                                                <span class="text-sm font-medium text-slate-700">Etkinlikleri Görüntüle</span>
                                            </label>
                                            <label class="flex cursor-pointer items-center gap-3 rounded-md p-2 ring-1 ring-slate-200 transition-colors has-[:checked]:bg-emerald-50 has-[:checked]:ring-emerald-400">
                                                <input type="checkbox" name="permissions" value="events.manage" class="h-4 w-4 rounded border-slate-300 text-emerald-600 focus:ring-emerald-600">
                                                <span class="text-sm font-medium text-slate-700">Etkinlikleri Yönet</span>
                                            </label>
                                            <label class="flex cursor-pointer items-center gap-3 rounded-md p-2 ring-1 ring-slate-200 transition-colors has-[:checked]:bg-emerald-50 has-[:checked]:ring-emerald-400">
                                                <input type="checkbox" name="permissions" value="reports.create" class="h-4 w-4 rounded border-slate-300 text-emerald-600 focus:ring-emerald-600">
                                                <span class="text-sm font-medium text-slate-700">Rapor Oluştur</span>
                                            </label>
                                            <label class="flex cursor-pointer items-center gap-3 rounded-md p-2 ring-1 ring-slate-200 transition-colors has-[:checked]:bg-emerald-50 has-[:checked]:ring-emerald-400">
                                                <input type="checkbox" name="permissions" value="regions.manage" class="h-4 w-4 rounded border-slate-300 text-emerald-600 focus:ring-emerald-600">
                                                <span class="text-sm font-medium text-slate-700">Bölgeleri Yönet</span>
                                            </label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="flex items-center justify-end gap-x-4 border-t border-slate-200 bg-slate-50 px-6 py-4">
                            <button type="button" id="cancelModalBtn" class="rounded-md bg-white px-3 py-2 text-sm font-semibold text-slate-900 shadow-sm ring-1 ring-inset ring-slate-300 hover:bg-slate-50">İptal</button>
                            <button type="submit" class="rounded-md bg-emerald-600 px-4 py-2 text-sm font-semibold text-white shadow-sm hover:bg-emerald-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-emerald-600">Kaydet</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
    
    <script>
function initRolYonetimi   () {
            const roleModal = document.getElementById('roleModal');
            const addNewRoleBtn = document.getElementById('addNewRoleBtn');
            const closeModalBtn = document.getElementById('closeModalBtn');
            const cancelModalBtn = document.getElementById('cancelModalBtn');
            const modalBackdrop = document.getElementById('modalBackdrop');
            const modalPanel = document.getElementById('modalPanel');
            const form = roleModal.querySelector('form');

            const openModal = () => {
                roleModal.classList.remove('hidden');
                document.body.style.overflow = 'hidden'; // Arka planın kaymasını engelle
                // Açılış animasyonunu tetikle
                setTimeout(() => {
                    modalBackdrop.classList.remove('opacity-0');
                    modalPanel.classList.remove('modal-scale-enter-from');
                }, 10);
            
            };
        
            const closeModal = () => {
                document.body.style.overflow = ''; // Kaydırmayı geri aç
                 // Kapanış animasyonunu tetikle
                modalBackdrop.classList.add('opacity-0');
                modalPanel.classList.add('modal-scale-leave-to');
                setTimeout(() => {
                    roleModal.classList.add('hidden');
                    if (form) form.reset();
                    // Animasyon sınıflarını temizle
                    modalPanel.classList.remove('modal-scale-leave-to');
                }, 200); // Transition süresiyle eşleşmeli
            };

            // Event Listeners
            if (addNewRoleBtn) addNewRoleBtn.addEventListener('click', openModal);
            if (closeModalBtn) closeModalBtn.addEventListener('click', closeModal);
            if (cancelModalBtn) cancelModalBtn.addEventListener('click', closeModal);

            // Overlay'e tıklayarak kapatma
            roleModal.addEventListener('click', (event) => {
                if (event.target === roleModal) closeModal();
            });

            // Form gönderimi
            if (form) {
                form.addEventListener('submit', (e) => {
                    e.preventDefault();
                    
                    const roleName = form.querySelector('#roleName').value.trim();
                    const roleDesc = form.querySelector('#roleDesc').value.trim();
                    const permissions = Array.from(form.querySelectorAll('input[name="permissions"]:checked')).map(chk => chk.value);
                    
                    if (!roleName) {
                        alert("Lütfen bir rol adı girin.");
                        return;
                    }

                    console.log("Kaydedilecek Rol:", { roleName, roleDesc, permissions });
                    alert(`"${roleName}" rolü başarıyla kaydedildi!`);

                    closeModal();
                });
            }
        }
        initRolYonetimi   ();
    </script>
</body>
</html>