<section class="bg-white page-content-bg rounded-[15px] p-6 h-full flex flex-col">
    <div class="flex justify-between items-center mb-6">
        <h1 class="text-2xl font-bold">Üye Listesi</h1>
        <button id="open-modal-btn" class="bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition-colors shadow-sm">
            <i class="fas fa-plus mr-2"></i>Yeni Üye Ekle
        </button>
    </div>
    
    <div class="flex-1 overflow-x-auto">
        <table class="w-full text-left" id="uye-tablosu">
            <thead class="bg-gray-50 border-b">
                <tr>
                    <th class="p-3 text-sm font-semibold text-gray-600">Ad Soyad</th>
                    <th class="p-3 text-sm font-semibold text-gray-600">Telefon</th>
                    <th class="p-3 text-sm font-semibold text-gray-600">Meslek</th>
                    <th class="p-3 text-sm font-semibold text-gray-600">Üyelik Tipi</th>
                    <th class="p-3 text-sm font-semibold text-gray-600 text-right">İşlemler</th>
                </tr>
            </thead>
            <tbody class="divide-y">
                <tr class="table-placeholder-row">
                    <td colspan="5" class="p-4 text-center text-gray-400">Henüz üye eklenmedi.</td>
                </tr>
            </tbody>
        </table>
    </div>
</section>

<div id="add-member-modal" class="fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4 invisible opacity-0 transition-opacity duration-300 ease-in-out">
    
    <div id="modal-panel" class="bg-white rounded-2xl shadow-2xl w-full max-w-4xl flex flex-col transform scale-95 opacity-0 transition-all duration-300 ease-in-out max-h-[90vh]">
        
        <div class="flex justify-between items-center p-5 border-b flex-shrink-0">
            <h2 class="text-xl font-semibold text-slate-700">Yeni Üye Kaydı</h2>
            <button class="close-modal-btn text-gray-400 hover:text-gray-600">
                <i class="fas fa-times fa-lg"></i>
            </button>
        </div>

        <div class="p-6 overflow-y-auto flex-grow bg-slate-50">
            <form id="add-member-form" class="space-y-8" novalidate>
                
                <div class="p-6 bg-white rounded-lg shadow-sm">
                    <h3 class="text-lg font-semibold text-slate-800 mb-6 border-b pb-3">Kişisel Bilgiler</h3>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                        <div class="md:col-span-1 flex flex-col items-center">
                            <label class="block text-sm font-medium text-gray-700 mb-2">Profil Fotoğrafı</label>
                            <div class="relative group">
                                <img id="image-preview" src="https://via.placeholder.com/128" class="w-32 h-32 rounded-full object-cover border-4 border-gray-200 group-hover:border-green-500 transition-all">
                                <label for="profile-picture-input" class="absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-50 flex items-center justify-center rounded-full cursor-pointer transition-all">
                                    <i class="fas fa-camera text-white text-2xl opacity-0 group-hover:opacity-100 transition-opacity"></i>
                                </label>
                                <input type="file" id="profile-picture-input" class="hidden" accept="image/*">
                            </div>
                        </div>
                        <div class="md:col-span-2 grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-5">
                            <div class="md:col-span-2">
                                <label for="ad-soyad" class="block text-sm font-medium text-gray-700 mb-1">Ad Soyad <span class="text-red-500">*</span></label>
                                <div class="relative">
                                    <i class="fas fa-user absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"></i>
                                    <input type="text" id="ad-soyad" name="ad-soyad" required class="pl-10 mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2 focus:ring-green-500 focus:border-green-500">
                                </div>
                                <div class="error-message text-red-500 text-xs mt-1 hidden">Bu alan zorunludur.</div>
                            </div>
                            <div>
                                <label for="dogum-tarihi" class="block text-sm font-medium text-gray-700 mb-1">Doğum Tarihi <span class="text-red-500">*</span></label>
                                <input type="date" id="dogum-tarihi" name="dogum-tarihi" required class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2 focus:ring-green-500 focus:border-green-500">
                                <div class="error-message text-red-500 text-xs mt-1 hidden">Bu alan zorunludur.</div>
                            </div>
                            <div>
                                <label for="kan-grubu" class="block text-sm font-medium text-gray-700 mb-1">Kan Grubu</label>
                                <select id="kan-grubu" name="kan-grubu" class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2">
                                    <option>Seçiniz...</option>
                                    <option>A Rh+</option> <option>A Rh-</option> <option>B Rh+</option> <option>B Rh-</option>
                                    <option>AB Rh+</option> <option>AB Rh-</option> <option>0 Rh+</option> <option>0 Rh-</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="p-6 bg-white rounded-lg shadow-sm">
                    <h3 class="text-lg font-semibold text-slate-800 mb-6 border-b pb-3">Eğitim ve Meslek Bilgileri</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-5">
                        <div>
                            <label for="meslek" class="block text-sm font-medium text-gray-700 mb-1">Meslek</label>
                            <input type="text" id="meslek" name="meslek" class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2">
                        </div>
                        <div>
                            <label for="egitim-durumu" class="block text-sm font-medium text-gray-700 mb-1">Eğitim Durumu</label>
                            <select id="egitim-durumu" name="egitim-durumu" class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2">
                                <option>Seçiniz...</option><option>İlköğretim</option><option>Lise</option><option>Önlisans</option><option>Lisans</option><option>Yüksek Lisans</option><option>Doktora</option>
                            </select>
                        </div>
                        <div>
                            <label for="okul" class="block text-sm font-medium text-gray-700 mb-1">Okul</label>
                            <input type="text" id="okul" name="okul" class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2">
                        </div>
                        <div>
                            <label for="bolum" class="block text-sm font-medium text-gray-700 mb-1">Bölüm</label>
                            <input type="text" id="bolum" name="bolum" class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2">
                        </div>
                    </div>
                </div>

                <div class="p-6 bg-white rounded-lg shadow-sm">
                    <h3 class="text-lg font-semibold text-slate-800 mb-6 border-b pb-3">İletişim Bilgileri</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-5">
                        <div>
                            <label for="telefon" class="block text-sm font-medium text-gray-700 mb-1">Telefon Numarası <span class="text-red-500">*</span></label>
                            <div class="relative">
                                <i class="fas fa-phone absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"></i>
                                <input type="tel" id="telefon" name="telefon" required placeholder="555 123 4567" class="pl-10 mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2 focus:ring-green-500 focus:border-green-500">
                            </div>
                            <div class="error-message text-red-500 text-xs mt-1 hidden">Bu alan zorunludur.</div>
                        </div>
                        <div>
                            <label for="email" class="block text-sm font-medium text-gray-700 mb-1">E-posta Adresi</label>
                            <div class="relative">
                                <i class="fas fa-envelope absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"></i>
                                <input type="email" id="email" name="email" class="pl-10 mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2 focus:ring-green-500 focus:border-green-500">
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="p-6 bg-white rounded-lg shadow-sm">
                    <h3 class="text-lg font-semibold text-slate-800 mb-6 border-b pb-3">Vakıf Bilgileri</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-5">
                        <div>
                            <label for="vakfi-nereden-duydunuz" class="block text-sm font-medium text-gray-700 mb-1">Vakfı Nereden Duydunuz?</label>
                            <input type="text" id="vakfi-nereden-duydunuz" name="vakfi-nereden-duydunuz" class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2" placeholder="Örn: Sosyal Medya, Arkadaş Tavsiyesi...">
                        </div>
                        <div>
                            <label for="uyelik-tipi" class="block text-sm font-medium text-gray-700 mb-1">Üyelik Tipi</label>
                            <select id="uyelik-tipi" name="uyelik-tipi" class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2">
                                <option>Standart Üye</option> <option>Öğrenci Üye</option> <option>Destekçi Üye</option>
                            </select>
                        </div>
                        <div class="md:col-span-2">
                            <label class="block text-sm font-medium text-gray-700 mb-2">İlgilendiği Alanlar / Komisyonlar</label>
                            <div class="grid grid-cols-2 md:grid-cols-4 gap-4 p-4 border rounded-lg">
                                <label class="flex items-center"><input type="checkbox" name="ilgi-alanlari" value="sosyal" class="h-4 w-4 text-green-600 rounded mr-2"> Sosyal Faaliyetler</label>
                                <label class="flex items-center"><input type="checkbox" name="ilgi-alanlari" value="medya" class="h-4 w-4 text-green-600 rounded mr-2"> Tanıtım ve Medya</label>
                                <label class="flex items-center"><input type="checkbox" name="ilgi-alanlari" value="arge" class="h-4 w-4 text-green-600 rounded mr-2"> AR-GE ve Proje</label>
                                <label class="flex items-center"><input type="checkbox" name="ilgi-alanlari" value="egitim" class="h-4 w-4 text-green-600 rounded mr-2"> Eğitim</label>
                            </div>
                        </div>
                    </div>
                </div>
            </form>
        </div>
        
        <div class="flex justify-end items-center gap-3 p-5 border-t bg-white flex-shrink-0 rounded-b-2xl">
            <button class="close-modal-btn bg-gray-200 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-300">İptal</button>
            <button type="submit" form="add-member-form" id="submit-button" class="bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 w-36 flex items-center justify-center">
                <span class="button-text">Üyeyi Kaydet</span>
                <i class="fas fa-spinner fa-spin ml-2 button-spinner hidden"></i>
            </button>
        </div>
    </div>
</div>

<script>
   
function initUyeListesi() {
    const modal = document.getElementById('add-member-modal');
    const modalPanel = document.getElementById('modal-panel');
    const openModalBtn = document.getElementById('open-modal-btn');
    const closeModalBtns = document.querySelectorAll('.close-modal-btn');
    const addMemberForm = document.getElementById('add-member-form');
    const profilePictureInput = document.getElementById('profile-picture-input');
    const imagePreview = document.getElementById('image-preview');
    const submitButton = document.getElementById('submit-button');
    const buttonText = submitButton.querySelector('.button-text');
    const buttonSpinner = submitButton.querySelector('.button-spinner');

    const clearFormErrors = () => {
        if (!addMemberForm) return;
        addMemberForm.querySelectorAll('[required]').forEach(input => {
            input.classList.remove('border-red-500');
            const errorMessage = input.closest('div').querySelector('.error-message');
            if (errorMessage) errorMessage.classList.add('hidden');
        });
    };
    
    const resetSubmitButton = () => {
        if (!submitButton) return;
        submitButton.disabled = false;
        if (buttonText) buttonText.textContent = 'Üyeyi Kaydet';
        if (buttonSpinner) buttonSpinner.classList.add('hidden');
    };

    const openModal = () => {
        if (!modal || !modalPanel) return;
        modal.classList.remove('invisible', 'opacity-0');
        modalPanel.classList.remove('opacity-0', 'scale-95');
        document.body.style.overflow = 'hidden';
    };

    const closeModal = () => {
        if (!modal || !modalPanel) return;
        modal.classList.add('opacity-0');
        modalPanel.classList.add('scale-95');
        document.body.style.overflow = '';
        
        setTimeout(() => {
            modal.classList.add('invisible');
            if (addMemberForm) addMemberForm.reset();
            if (imagePreview) imagePreview.src = 'https://via.placeholder.com/128';
            clearFormErrors();
            resetSubmitButton();
        }, 200);
    };
    
    const validateForm = () => {
        if (!addMemberForm) return false;
        let isValid = true;
        clearFormErrors();
        addMemberForm.querySelectorAll('[required]').forEach(input => {
            if (!input.value.trim()) {
                isValid = false;
                input.classList.add('border-red-500');
                const errorMessage = input.closest('div').querySelector('.error-message');
                if (errorMessage) errorMessage.classList.remove('hidden');
            }
        });
        return isValid;
    };

    if(openModalBtn) openModalBtn.addEventListener('click', openModal);
    
    closeModalBtns.forEach(btn => btn.addEventListener('click', closeModal));

    if(modal) modal.addEventListener('click', (e) => {
        if (e.target === modal) closeModal();
    });

    document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape' && modal && !modal.classList.contains('invisible')) {
            closeModal();
        }
    });

    if(profilePictureInput) profilePictureInput.addEventListener('change', function(event) {
        const file = event.target.files[0];
        if (file) {
            const reader = new FileReader();
            reader.onload = function(e) { 
                if (imagePreview) imagePreview.src = e.target.result;
            }
            reader.readAsDataURL(file);
        }
    });

    if(addMemberForm) addMemberForm.addEventListener('submit', function(e) {
        e.preventDefault();
        if (validateForm()) {
            if (submitButton) {
                submitButton.disabled = true;
                if (buttonText) buttonText.textContent = 'Kaydediliyor...';
                if (buttonSpinner) buttonSpinner.classList.remove('hidden');
            }
            
            setTimeout(() => {
                const formData = new FormData(addMemberForm);
                const uyeVerileri = Object.fromEntries(formData.entries());
                console.log("Kaydedilecek Üye Verileri:", uyeVerileri);
                alert(`${uyeVerileri['ad-soyad']} adlı üye başarıyla kaydedildi! (Detaylar konsolda)`);
                closeModal();
            }, 1500);
        }
    });
}

</script>